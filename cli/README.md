# claptime-cli

The Claptime project CLI.

[![oclif](https://img.shields.io/badge/cli-oclif-brightgreen.svg)](https://oclif.io)

This file can be generated by running `npx oclif-dev readme`;

<!-- toc -->
* [claptime-cli](#claptime-cli)
* [Usage](#usage)
* [Commands](#commands)
<!-- tocstop -->

# Usage

<!-- usage -->
```sh-session
$ npm install -g claptime-cli
$ claptime COMMAND
running command...
$ claptime (-v|--version|version)
claptime-cli/0.0.0 darwin-x64 node-v12.18.3
$ claptime --help [COMMAND]
USAGE
  $ claptime COMMAND
...
```
<!-- usagestop -->

# Commands

<!-- commands -->
* [`claptime deploy:all`](#claptime-deployall)
* [`claptime deploy:single`](#claptime-deploysingle)
* [`claptime flush:all`](#claptime-flushall)
* [`claptime flush:cognito`](#claptime-flushcognito)
* [`claptime flush:dynamodb`](#claptime-flushdynamodb)
* [`claptime flush:s3`](#claptime-flushs3)
* [`claptime help [COMMAND]`](#claptime-help-command)
* [`claptime migrate:01-person-to-profile`](#claptime-migrate01-person-to-profile)
* [`claptime migrate:02-film-to-fiction`](#claptime-migrate02-film-to-fiction)
* [`claptime migrate:03-add-video-indexes`](#claptime-migrate03-add-video-indexes)
* [`claptime migrate:04-remove-custom-role`](#claptime-migrate04-remove-custom-role)
* [`claptime migrate:05-split-collection-profile`](#claptime-migrate05-split-collection-profile)
* [`claptime migrate:06-copy-views`](#claptime-migrate06-copy-views)
* [`claptime migrate:06-import-views-from-json`](#claptime-migrate06-import-views-from-json)
* [`claptime migrate:06-video-to-videonode`](#claptime-migrate06-video-to-videonode)
* [`claptime migrate:07-seed-initial-collection`](#claptime-migrate07-seed-initial-collection)
* [`claptime migrate:07-seed-other-collections`](#claptime-migrate07-seed-other-collections)
* [`claptime migrate:08-videonode-status`](#claptime-migrate08-videonode-status)
* [`claptime migrate:09-videonode-description-to-synopsis`](#claptime-migrate09-videonode-description-to-synopsis)
* [`claptime migrate:10-favorites`](#claptime-migrate10-favorites)
* [`claptime regenerate-thumbnails`](#claptime-regenerate-thumbnails)
* [`claptime seed:all`](#claptime-seedall)
* [`claptime seed:cognito`](#claptime-seedcognito)
* [`claptime seed:dynamodb`](#claptime-seeddynamodb)
* [`claptime seed:s3`](#claptime-seeds3)
* [`claptime setup-env`](#claptime-setup-env)
* [`claptime tag-resources`](#claptime-tag-resources)

## `claptime deploy:all`

Deploy all services

```
USAGE
  $ claptime deploy:all

OPTIONS
  -y, --yes  Automatic yes to prompts; assume "yes" as answer to all prompts and run non-interactively.
```

## `claptime deploy:single`

Deploy images service.

```
USAGE
  $ claptime deploy:single

OPTIONS
  -s, --service=service  The service name
  -y, --yes              Automatic yes to prompts; assume "yes" as answer to all prompts and run non-interactively.
```

## `claptime flush:all`

Flush all

```
USAGE
  $ claptime flush:all

OPTIONS
  -y, --yes  Automatic yes to prompts; assume "yes" as answer to all prompts and run non-interactively.

DESCRIPTION
  Flush cognito, dynamodb and s3.
```

## `claptime flush:cognito`

Flush cognito

```
USAGE
  $ claptime flush:cognito

OPTIONS
  -y, --yes  Automatic yes to prompts; assume "yes" as answer to all prompts and run non-interactively.

DESCRIPTION
  Flush cognito users.
```

## `claptime flush:dynamodb`

Flush dynamodb

```
USAGE
  $ claptime flush:dynamodb

OPTIONS
  -y, --yes  Automatic yes to prompts; assume "yes" as answer to all prompts and run non-interactively.

DESCRIPTION
  Flush dynamodb tables.
```

## `claptime flush:s3`

Flush s3

```
USAGE
  $ claptime flush:s3

OPTIONS
  -y, --yes  Automatic yes to prompts; assume "yes" as answer to all prompts and run non-interactively.

DESCRIPTION
  Flush s3 bucket.
```

## `claptime help [COMMAND]`

display help for claptime

```
USAGE
  $ claptime help [COMMAND]

ARGUMENTS
  COMMAND  command to show help for

OPTIONS
  --all  see all commands in CLI
```

_See code: [@oclif/plugin-help](https://github.com/oclif/plugin-help/blob/v2.2.1/src/commands/help.ts)_

## `claptime migrate:01-person-to-profile`

Rename Person to Profile

```
USAGE
  $ claptime migrate:01-person-to-profile

OPTIONS
  -y, --yes  Automatic yes to prompts; assume "yes" as answer to all prompts and run non-interactively.

DESCRIPTION
  https://github.com/claptime/claptime/pull/286
  - S3 Storage bucket: move public/persons to public/profiles
  - AppSync model changes:
     - Person: dump data into Profile table, just concatenate firstName and lastName into name
     - Credit: rename creditPersonId/customPerson fields into creditProfileId/customProfile
     - Video: rename videoPersonId field into videoProfileId
     - UserSettings: rename collectionId field into personId
```

## `claptime migrate:02-film-to-fiction`

Rename FILM category to FICTION

```
USAGE
  $ claptime migrate:02-film-to-fiction

OPTIONS
  -y, --yes  Automatic yes to prompts; assume "yes" as answer to all prompts and run non-interactively.

DESCRIPTION
  https://github.com/claptime/claptime/pull/290
```

## `claptime migrate:03-add-video-indexes`

Add 2 indexes on Video table:

```
USAGE
  $ claptime migrate:03-add-video-indexes

OPTIONS
  -y, --yes  Automatic yes to prompts; assume "yes" as answer to all prompts and run non-interactively.

DESCRIPTION
  - createdAt#category
  - title#category
  Need to backfill values for all items.
  Hasn't beend used in the end, keeping code for later.
```

## `claptime migrate:04-remove-custom-role`

Prior to this script, we had both role (enum) and customRole (string) fields on Credit.

```
USAGE
  $ claptime migrate:04-remove-custom-role

OPTIONS
  -y, --yes  Automatic yes to prompts; assume "yes" as answer to all prompts and run non-interactively.

DESCRIPTION
  We removed the enum to only keep custom strings in the role field.
```

## `claptime migrate:05-split-collection-profile`

Do not anymore use a Collection with UPLOADED_VIDEO type to store profile videos.

```
USAGE
  $ claptime migrate:05-split-collection-profile

OPTIONS
  -d, --dry-run  Run the command with DRY_RUN environment variable, which should skip all write operations.
  -y, --yes      Automatic yes to prompts; assume "yes" as answer to all prompts and run non-interactively.

DESCRIPTION
  https://github.com/claptime/claptime/pull/328
  - Convert CollectionVideo of Collection(type=UPLOADED_VIDEOS) to ProfileVideo
  - Convert CollectionUsers into UserProfile
```

## `claptime migrate:06-copy-views`

Copy data from View table into file

```
USAGE
  $ claptime migrate:06-copy-views

OPTIONS
  -y, --yes  Automatic yes to prompts; assume "yes" as answer to all prompts and run non-interactively.
```

## `claptime migrate:06-import-views-from-json`

Import data from file into View table

```
USAGE
  $ claptime migrate:06-import-views-from-json

OPTIONS
  -y, --yes  Automatic yes to prompts; assume "yes" as answer to all prompts and run non-interactively.
```

## `claptime migrate:06-video-to-videonode`

Rename Video to VideoNode

```
USAGE
  $ claptime migrate:06-video-to-videonode

OPTIONS
  -y, --yes  Automatic yes to prompts; assume "yes" as answer to all prompts and run non-interactively.

DESCRIPTION
  https://github.com/claptime/claptime/pull/329
  - S3 Storage bucket: move public/videos to public/videoNodes
  - AppSync model changes:
     - Video: dump data into VideoNode table, change videoProfileId to videoNodeProfileId
     - UserVideo: dump data into UserVideoNode table, change userSettingsVideosId to userSettingsVideoNodesId,
  userVideoVideoId to userVideoNodeVideoNodeId, ist#userVideoVideoId to list#userVideoNodeVideoNodeId
     - CollectionVideo: dump data into CollectionVideoNode table, change collectionVideoVideoId to
  collectionVideoNodeVideoNodeId, collectionVideoCollectionId to collectionVideoNodeCollectionId
     - Credit: rename creditVideoId field into creditVideoNodeId
```

## `claptime migrate:07-seed-initial-collection`

Add all published videos/series to "La scène ouverte" collection, with video category = collection category.

```
USAGE
  $ claptime migrate:07-seed-initial-collection

OPTIONS
  -y, --yes  Automatic yes to prompts; assume "yes" as answer to all prompts and run non-interactively.

DESCRIPTION
  Add all published videos/series to "La scène ouverte" collection, with video category = collection category.
```

## `claptime migrate:07-seed-other-collections`

Seed other initial collections based on a manual distribution.

```
USAGE
  $ claptime migrate:07-seed-other-collections

OPTIONS
  -y, --yes  Automatic yes to prompts; assume "yes" as answer to all prompts and run non-interactively.

DESCRIPTION
  Seed other initial collections based on a manual distribution.
```

## `claptime migrate:08-videonode-status`

https://github.com/claptime/claptime/pull/365

```
USAGE
  $ claptime migrate:08-videonode-status

OPTIONS
  -y, --yes  Automatic yes to prompts; assume "yes" as answer to all prompts and run non-interactively.

DESCRIPTION
  - VideoNode status: PROCESSED -> DRAFT
  - CollectionVideoNode: adding a APPROVED status to existing items
  - VideoNode: Set childrenCount for existing series
```

## `claptime migrate:09-videonode-description-to-synopsis`

- VideoNode: description -> synopsis

```
USAGE
  $ claptime migrate:09-videonode-description-to-synopsis

OPTIONS
  -y, --yes  Automatic yes to prompts; assume "yes" as answer to all prompts and run non-interactively.

DESCRIPTION
  - VideoNode: description -> synopsis
```

## `claptime migrate:10-favorites`

- Renaming LIKED list to TO_WATCH

```
USAGE
  $ claptime migrate:10-favorites

OPTIONS
  -y, --yes  Automatic yes to prompts; assume "yes" as answer to all prompts and run non-interactively.

DESCRIPTION
  - Renaming LIKED list to TO_WATCH
```

## `claptime regenerate-thumbnails`

Regenerate thumbnails by reprocessing the original.jpg file.

```
USAGE
  $ claptime regenerate-thumbnails

OPTIONS
  -t, --type=type  One of videos, profiles and collections
  -y, --yes        Automatic yes to prompts; assume "yes" as answer to all prompts and run non-interactively.

DESCRIPTION
  Works for Video, Profile and Collection.
```

## `claptime seed:all`

Seed all

```
USAGE
  $ claptime seed:all

OPTIONS
  -f, --flush  Flush data before inserting items
  -y, --yes    Automatic yes to prompts; assume "yes" as answer to all prompts and run non-interactively.
  --from=from  Seed data from an existing env instead of fixtures

DESCRIPTION
  Seed cognito, dynamodb and s3.
```

## `claptime seed:cognito`

Seed cognito

```
USAGE
  $ claptime seed:cognito

OPTIONS
  -f, --flush  Flush users before creating new ones
  -y, --yes    Automatic yes to prompts; assume "yes" as answer to all prompts and run non-interactively.

DESCRIPTION
  Create two users: admin and regular.
```

## `claptime seed:dynamodb`

Seed dynamodb

```
USAGE
  $ claptime seed:dynamodb

OPTIONS
  -f, --flush  Flush table before inserting items
  -y, --yes    Automatic yes to prompts; assume "yes" as answer to all prompts and run non-interactively.
  --from=from  Seed data from an existing env instead of fixtures

DESCRIPTION
  Seed (and optionnally flush) dynamodb tables.
```

## `claptime seed:s3`

Seed s3

```
USAGE
  $ claptime seed:s3

OPTIONS
  -f, --flush  Flush bucket before inserting items
  -y, --yes    Automatic yes to prompts; assume "yes" as answer to all prompts and run non-interactively.
  --from=from  Seed data from an existing env instead of fixtures

DESCRIPTION
  Seed (and optionnally flush) s3 bucket.
```

## `claptime setup-env`

Setup Claptime environment

```
USAGE
  $ claptime setup-env

OPTIONS
  -y, --yes  Automatic yes to prompts; assume "yes" as answer to all prompts and run non-interactively.

DESCRIPTION
  - Create Route 53 record sets
```

## `claptime tag-resources`

Tag resources (dynamodb tables) for backup plan

```
USAGE
  $ claptime tag-resources

OPTIONS
  -y, --yes  Automatic yes to prompts; assume "yes" as answer to all prompts and run non-interactively.

DESCRIPTION
  Shouldn't be necessary if this issue is resolved: https://github.com/aws-amplify/amplify-cli/issues/2794
```
<!-- commandsstop -->
